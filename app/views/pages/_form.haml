= form_for [ @section, @page ]  do |f|
  - if @page.errors.any?
    = render 'shared/error_explanation', :object => @page
  
  #page_content
    = f.hidden_field :keywords, :id => :final_keywords_list
    %label{ :for => :page_name }
      Name
      %small Your page name will be used to create a friendly url, pick one wisely.
    = f.text_field  :name
    = f.text_area :content, :class => 'wymeditor'

    %label{ :for => :page_section_id }
      Section
      %small Every page must belong to a section, section names are also use for friendly urls.
    = f.select  :section_id, Section.all.collect { |section| [ section.name, section.id ] }, :include_blank => false
        
    .buttonset
      = f.check_box :home_page, :class => 'home-page'
      = f.label :home_page?, 'Is Home page?'
      = f.check_box :has_contact, :class => 'contact-form'
      = f.label :has_contact?, 'Has contact form?'
      = f.check_box :published, :class => 'published', :checked => true
      = f.label     :published?
      
    - f.fields_for :images do |image|
      = render 'shared/assets', :f => image
      
    %button{ :class => 'wymupdate' } Submit
    
- content_for :sidebar do
  #operations_placeholder
    %h3 Pages Operations
    - if params[:action] == 'edit'
      = link_to 'Create a new page', new_section_page_path(@section), :class => 'icon icon_page_add'
    = link_to 'Create a new section', new_section_path, :class => 'icon icon_add'
    = link_to 'Edit this page section', edit_section_path(@section), :class => 'icon icon_edit'
    = link_to 'Go back to this section the page list', section_pages_path(@section), :class => 'icon icon_back'
    
:javascript
  $(document).ready(function() {
    $('#tabs').tabs();
    $('.wymupdate').button({ icons: { primary: "ui-icon-circle-check" } });
    $('.buttonset').buttonset();
    $('.home-page').button({ icons: { primary: "ui-icon-home" } });
    $('.contact-form').button({ icons: { primary: "ui-icon-mail-closed" } });
    $('.published').button({ icons: { primary: "ui-icon-check" } });
    $('#new_page_menu_link').addClass('selected');
    $('#keyword_button').button({ icons: { primary: "ui-icon-circle-plus" } });
    $('#keyword_button').css('position', 'relative').css('top', '-5px');
    add_keywords();
    existing_keywords();
  });